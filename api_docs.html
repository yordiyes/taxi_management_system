<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taxi API Docs | Premium Developer Console</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6366f1;
            --primary-glow: rgba(99, 102, 241, 0.4);
            --bg: #0f172a;
            --surface: #1e293b;
            --text: #f8fafc;
            --text-dim: #94a3b8;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --glass: rgba(30, 41, 59, 0.7);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Ambient Background */
        .ambient-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .blob {
            position: absolute;
            filter: blur(80px);
            opacity: 0.15;
            border-radius: 50%;
            animation: move 20s infinite alternate;
        }

        @keyframes move {
            from { transform: translate(0, 0); }
            to { transform: translate(20%, 30%); }
        }

        /* Layout */
        .container {
            display: grid;
            grid-template-columns: 300px 1fr 400px;
            height: 100vh;
        }

        /* Sidebar */
        aside {
            background: var(--surface);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            padding: 2rem;
            overflow-y: auto;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--primary);
        }

        .nav-group {
            margin-bottom: 2rem;
        }

        .nav-group-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-dim);
            margin-bottom: 1rem;
        }

        .nav-item {
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(5px);
        }

        .nav-item.active {
            background: var(--primary);
            color: white;
        }

        .method {
            font-size: 0.7rem;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 4px;
            text-transform: uppercase;
        }

        .method.get { background: var(--success); }
        .method.post { background: var(--warning); }
        .method.put { background: var(--primary); }
        .method.delete { background: var(--danger); }

        /* Main Content */
        main {
            padding: 3rem;
            overflow-y: auto;
            scroll-behavior: smooth;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            background: rgba(99, 102, 241, 0.1);
            color: var(--primary);
            font-weight: 600;
            font-size: 0.8rem;
            margin-bottom: 1rem;
        }

        h1 { font-size: 2.5rem; margin-bottom: 1rem; }
        .endpoint-url {
            font-family: 'JetBrains Mono', monospace;
            background: rgba(0, 0, 0, 0.3);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 2rem 0 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 0.5rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 2rem;
        }

        th, td {
            text-align: left;
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        th { color: var(--text-dim); font-size: 0.85rem; font-weight: 500; }

        /* Console */
        .console {
            background: #000;
            padding: 2rem;
            overflow-y: auto;
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .console-header {
            font-weight: 600;
            color: var(--text-dim);
            font-size: 0.9rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .try-it-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 15px var(--primary-glow);
        }

        .try-it-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--primary-glow);
        }

        .code-block {
            background: #1e1e1e;
            padding: 1rem;
            border-radius: 8px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            position: relative;
            border: 1px solid #333;
        }

        .code-block pre {
            color: #dcdcdc;
            white-space: pre-wrap;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: transparent;
            color: var(--text-dim);
            border: none;
            cursor: pointer;
            padding: 5px;
        }

        .input-field {
            background: #333;
            border: 1px solid #444;
            color: white;
            padding: 8px;
            border-radius: 4px;
            width: 100%;
            margin-top: 5px;
            font-family: 'JetBrains Mono', monospace;
        }

        .test-params {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .container { grid-template-columns: 250px 1fr; }
            .console { grid-column: 1 / -1; height: auto; border-top: 1px solid rgba(255, 255, 255, 0.1); }
        }

        @media (max-width: 768px) {
            .container { grid-template-columns: 1fr; }
            aside { display: none; }
        }
    </style>
</head>
<body>
    <div class="ambient-bg">
        <div class="blob" style="width: 400px; height: 400px; background: var(--primary); top: 10%; right: 10%;"></div>
        <div class="blob" style="width: 300px; height: 300px; background: #9333ea; bottom: 10%; left: 10%;"></div>
    </div>

    <div class="container">
        <!-- Sidebar -->
        <aside>
            <div class="logo">
                <i class="fas fa-taxi"></i>
                TaxiAPI
            </div>
            
            <div class="nav-group">
                <div class="nav-group-title">Introduction</div>
                <div class="nav-item active" onclick="showSection('intro')">
                    <i class="fas fa-rocket"></i> Getting Started
                </div>
                <div class="nav-item" onclick="showSection('group-onboarding')">
                    <i class="fas fa-users"></i> Group Integration
                </div>
                <div class="nav-item" onclick="showSection('auth-guide')">
                    <i class="fas fa-key"></i> Authentication
                </div>
            </div>

            <div class="nav-group">
                <div class="nav-group-title">Endpoints</div>
                <div class="nav-item" onclick="selectEndpoint('get-services')">
                    <span class="method get">GET</span> Services
                </div>
                <div class="nav-item" onclick="selectEndpoint('post-booking')">
                    <span class="method post">POST</span> Bookings
                </div>
                <div class="nav-item" onclick="selectEndpoint('get-bookings')">
                    <span class="method get">GET</span> Bookings
                </div>
                <div class="nav-item" onclick="selectEndpoint('auth-login')">
                    <span class="method post">POST</span> Login
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main id="main-content">
            <div id="intro-section">
                <span class="badge">EXTERNAL GROUP API</span>
                <h1>Partner Integration Portal</h1>
                <p>This documentation is specifically designed for <strong>external project groups</strong> looking to consume the Taxi Management System services. Connect your application to our taxi fleet seamlessly.</p>
                
                <h2 class="section-title">Base URL</h2>
                <div class="endpoint-url">https://taxi-system.infinityfreeapp.com/api</div>
                
                <h2 class="section-title">How to Integrate as a Group</h2>
                <p>1. <strong>Use the Shared Key:</strong> All your requests must include the <code>X-API-KEY</code> header.<br>
                   2. <strong>Identify Users:</strong> When booking via API, you must provide a <code>user_id</code> from our system so we know which customer you are booking for.<br>
                   3. <strong>Handle Responses:</strong> Our API returns standard JSON. Ensure your service handles error codes (401 for bad keys, 400 for bad data).</p>
            </div>

            <div id="group-onboarding" style="display: none;">
                <span class="badge">ONBOARDING GUIDE</span>
                <h1>Service-to-Service Integration</h1>
                <p>If you are developing a Restaurant, Hotel, or Event app, you can use these endpoints to provide direct transportation to your users.</p>
                
                <h2 class="section-title">Recommended Flow</h2>
                <div class="code-block" style="background: rgba(255,255,255,0.05); margin-bottom: 2rem;">
                    <pre style="color: var(--text);">
1. GET /services.php          -> Show car types to your user
2. POST /bookings.php         -> Send booking from your server
3. GET /bookings.php?user_id= -> Track booking status for your user</pre>
                </div>

                <h2 class="section-title">Your Group Assets</h2>
                <table style="background: rgba(0,0,0,0.2); border-radius: 8px;">
                    <tr>
                        <td><strong>Integration Key</strong></td>
                        <td><code>TAXI_GROUP_SECURE_KEY_2024</code></td>
                    </tr>
                    <tr>
                        <td><strong>Header Name</strong></td>
                        <td><code>X-API-KEY</code></td>
                    </tr>
                    <tr>
                        <td><strong>Support</strong></td>
                        <td>Contact our team for specific Group ID assignments.</td>
                    </tr>
                </table>
            </div>

            <div id="endpoint-detail" style="display: none;">
                <span class="badge" id="ep-tag">API ENDPOINT</span>
                <h1 id="ep-title">Get Services</h1>
                <p id="ep-desc">Retrieve a list of all available taxi services and their pricing.</p>
                
                <h2 class="section-title">HTTP Request</h2>
                <div class="endpoint-url">
                    <span class="method get" id="ep-method-badge">GET</span>
                    <span id="ep-full-url">/services.php</span>
                </div>

                <h2 class="section-title">Parameters</h2>
                <table id="params-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody id="params-body">
                        <!-- Dynamic -->
                    </tbody>
                </table>
            </div>
        </main>

        <!-- Console -->
        <div class="console">
            <div class="console-header">
                TEST CONSOLE
                <i class="fas fa-terminal"></i>
            </div>

            <div id="test-inputs" class="test-params">
                <!-- Dynamic Inputs -->
                <div>
                    <label style="font-size: 0.8rem; color: var(--text-dim);">API KEY</label>
                    <input type="text" id="api-key-input" class="input-field" value="TAXI_GROUP_SECURE_KEY_2024">
                </div>
                <div id="dynamic-params-inputs"></div>
            </div>

            <button class="try-it-btn" onclick="executeTest()">Send Request</button>

            <div class="console-header">RESPONSE</div>
            <div class="code-block">
                <button class="copy-btn"><i class="fas fa-copy"></i></button>
                <pre id="response-output">// Response will appear here after request</pre>
            </div>

            <div class="console-header">JS SNIPPET</div>
            <div class="code-block">
                <pre id="js-snippet-output">// Snippet will appear here</pre>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = "https://taxi-system.infinityfreeapp.com/api";
        
        const endpoints = {
            'get-services': {
                title: 'Get Services',
                desc: 'Retrieve all available taxi services, including base prices and per-KM rates.',
                method: 'GET',
                path: '/services.php',
                params: [
                    { name: 'id', type: 'Integer', desc: 'Optional. Get a specific service by ID.' }
                ]
            },
            'post-booking': {
                title: 'Create Booking',
                desc: 'Create a new taxi booking request.',
                method: 'POST',
                path: '/bookings.php',
                params: [
                    { name: 'email', type: 'String', desc: 'Seamless Booking: Provide user email to auto-identify/register.', required: false },
                    { name: 'user_id', type: 'Integer', desc: 'Optional if email is provided.', required: false },
                    { name: 'pickup_location', type: 'String', desc: 'Pickup address.', required: true },
                    { name: 'dropoff_location', type: 'String', desc: 'Destination address.', required: true },
                    { name: 'pickup_time', type: 'String', desc: 'Format: YYYY-MM-DD HH:MM:SS', required: true },
                    { name: 'service_id', type: 'Integer', desc: 'The ID of the chosen taxi service.' }
                ]
            },
            'get-bookings': {
                title: 'View Bookings',
                desc: 'Get bookings associated with a user. Partners can filter by email.',
                method: 'GET',
                path: '/bookings.php',
                params: [
                    { name: 'email', type: 'String', desc: 'Filter by user email (Recommended for partners).' },
                    { name: 'user_id', type: 'Integer', desc: 'Filter by internal user ID.' }
                ]
            },
            'auth-login': {
                title: 'User Login',
                desc: 'Authenticate a user and get session data.',
                method: 'POST',
                path: '/auth.php?action=login',
                params: [
                    { name: 'email', type: 'String', desc: 'User email.', required: true },
                    { name: 'password', type: 'String', desc: 'User password.', required: true }
                ]
            }
        };

        let currentEndpointKey = 'get-services';

        function showSection(section) {
            document.getElementById('intro-section').style.display = 'none';
            document.getElementById('group-onboarding').style.display = 'none';
            document.getElementById('endpoint-detail').style.display = 'none';
            
            document.getElementById(section + '-section')?.style.display || (document.getElementById(section).style.display = 'block');
            
            // Update nav active state
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            if (event) event.currentTarget.classList.add('active');
        }

        function selectEndpoint(key) {
            currentEndpointKey = key;
            const ep = endpoints[key];
            
            document.getElementById('intro-section').style.display = 'none';
            document.getElementById('endpoint-detail').style.display = 'block';
            
            document.getElementById('ep-title').innerText = ep.title;
            document.getElementById('ep-desc').innerText = ep.desc;
            document.getElementById('ep-full-url').innerText = ep.path;
            document.getElementById('ep-method-badge').innerText = ep.method;
            document.getElementById('ep-method-badge').className = 'method ' + ep.method.toLowerCase();

            // Render Table
            const tbody = document.getElementById('params-body');
            tbody.innerHTML = '';
            ep.params.forEach(p => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${p.name} ${p.required ? '<span style="color:var(--danger)">*</span>' : ''}</td><td>${p.type}</td><td>${p.desc}</td>`;
                tbody.appendChild(tr);
            });

            // Render Console Inputs
            const inputContainer = document.getElementById('dynamic-params-inputs');
            inputContainer.innerHTML = '';
            ep.params.forEach(p => {
                const div = document.createElement('div');
                div.style.marginBottom = "10px";
                div.innerHTML = `
                    <label style="font-size: 0.8rem; color: var(--text-dim);">${p.name.toUpperCase()}</label>
                    <input type="text" id="input-${p.name}" class="input-field" placeholder="${p.desc}">
                `;
                inputContainer.appendChild(div);
            });

            updateSnippet();
            
            // Update nav active state
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }

        function updateSnippet() {
            const ep = endpoints[currentEndpointKey];
            const apiKey = document.getElementById('api-key-input').value;
            let snippet = '';

            if (ep.method === 'GET') {
                snippet = `fetch("${API_BASE}${ep.path}?api_key=${apiKey}")\n  .then(r => r.json())\n  .then(console.log);`;
            } else {
                let body = {};
                ep.params.forEach(p => {
                    body[p.name] = document.getElementById(`input-${p.name}`)?.value || (p.type === 'Integer' ? 1 : 'value');
                });
                snippet = `fetch("${API_BASE}${ep.path}", {\n  method: "POST",\n  headers: {\n    "Content-Type": "application/json",\n    "X-API-KEY": "${apiKey}"\n  },\n  body: JSON.stringify(${JSON.stringify(body, null, 2)})\n})\n.then(r => r.json())\n.then(console.log);`;
            }
            document.getElementById('js-snippet-output').innerText = snippet;
        }

        async function executeTest() {
            const ep = endpoints[currentEndpointKey];
            const apiKey = document.getElementById('api-key-input').value;
            const output = document.getElementById('response-output');
            output.innerText = "// Requesting...";

            let url = API_BASE + ep.path;
            let options = {
                headers: {
                    'Content-Type': 'application/json'
                }
            };

            if (ep.method === 'GET') {
                const urlObj = new URL(url);
                urlObj.searchParams.append('api_key', apiKey);
                ep.params.forEach(p => {
                    const val = document.getElementById(`input-${p.name}`).value;
                    if(val) urlObj.searchParams.append(p.name, val);
                });
                url = urlObj.toString();
            } else {
                options.method = ep.method;
                options.headers['X-API-KEY'] = apiKey;
                let body = {};
                ep.params.forEach(p => {
                    const val = document.getElementById(`input-${p.name}`).value;
                    if(val) body[p.name] = val;
                });
                options.body = JSON.stringify(body);
            }

            try {
                const response = await fetch(url, options);
                const data = await response.json();
                output.innerText = JSON.stringify(data, null, 2);
            } catch (err) {
                output.innerText = "Error: " + err.message + "\n\nNote: If this is a CORS error, the deployed API might need to allow this specific origin or set Access-Control-Allow-Origin: *";
            }
        }

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            selectEndpoint('get-services');
        });
    </script>
</body>
</html>
